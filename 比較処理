function updateSheets() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheetA = ss.getSheetByName("Aシート");
  var sheetB = ss.getSheetByName("Bシート");
  
  var dataA = sheetA.getDataRange().getValues();
  var dataB = sheetB.getDataRange().getValues();
  
  var headerA = dataA[0];
  var idColumnA = headerA.indexOf("ID");
  var remarkColumnA = headerA.indexOf("備考");
  
  var headerB = dataB[0];
  var idColumnB = headerB.indexOf("ID");
  var remarkColumnB = headerB.indexOf("備考");
  
  var timestamp = Utilities.formatDate(new Date(), "Asia/Tokyo", "yyyy/MM");
  
  for (var i = 1; i < dataB.length; i++) {
    var idB = dataB[i][idColumnB];
    var remarkB = dataB[i][remarkColumnB];
    
    if (idB && remarkB) {
      var found = false;
      
      for (var j = 1; j < dataA.length; j++) {
        if (dataA[j][idColumnA] === idB) {
          // 既存のIDの場合、備考を更新
          dataA[j][remarkColumnA] += "\n" + timestamp + " " + remarkB;
          found = true;
          break;
        }
      }
      
      if (!found) {
        // 新規IDの場合、新しい行を追加
        var newRow = new Array(headerA.length);
        for (var k = 0; k < headerB.length; k++) {
          var columnIndex = headerA.indexOf(headerB[k]);
          if (columnIndex !== -1) {
            newRow[columnIndex] = dataB[i][k];
          }
        }
        newRow[remarkColumnA] = timestamp + " " + remarkB;
        dataA.push(newRow);
      }
    }
  }
  
  // シートAを更新
  sheetA.getRange(1, 1, dataA.length, dataA[0].length).setValues(dataA);
}
