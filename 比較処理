function updateSheet() {
  var ss = SpreadshreadApp.getActiveSpreadsheet();
  var sheetA = ss.getSheetByName('Aシート');
  var sheetB = ss.getSheetByName('Bシート');

  var dataA = sheetA.getDataRange().getValues();
  var dataB = sheetB.getDataRange().getValues();

  var headerA = dataA[0];
  var idIndexA = headerA.indexOf('ID');
  var dateIndexA = headerA.indexOf('確認日');

  var headerB = dataB[0];
  var idIndexB = headerB.indexOf('ID');
  var dateIndexB = headerB.indexOf('確認日');

  for (var i = 1; i < dataA.length; i++) {
    var idA = dataA[i][idIndexA];
    var dateA = dataA[i][dateIndexA];

    for (var j = 1; j < dataB.length; j++) {
      var idB = dataB[j][idIndexB];
      var dateB = dataB[j][dateIndexB];

      if (idA === idB) {
        if (dateA === dateB) {
          // 日付が同じ場合、Bシートの値をそのまま使用
          sheetA.getRange(i + 1, dateIndexA + 1).setValue(dateB);
        } else {
          // 日付が異なる場合、メモを更新
          var newDate = new Date(dateB);
          var oneMonthAgo = new Date(newDate.setMonth(newDate.getMonth() - 1));
          var formattedDate = Utilities.formatDate(oneMonthAgo, 'Asia/Tokyo', 'yyyy/MM/dd');
          var updatedValue = dateB + '\n' + formattedDate + ' ' + dateB;
          sheetA.getRange(i + 1, dateIndexA + 1).setValue(updatedValue);
        }
        break;
      }
    }
  }
}
