function updateSheets() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheetA = ss.getSheetByName("Aシート");
  var sheetB = ss.getSheetByName("Bシート");
  
  var dataA = sheetA.getDataRange().getValues();
  var dataB = sheetB.getDataRange().getValues();
  
  var headerA = dataA[0];
  var idColumnA = headerA.indexOf("ID");
  var remarkColumnA = headerA.indexOf("備考");
  
  var headerB = dataB[0];
  var idColumnB = headerB.indexOf("ID");
  var remarkColumnB = headerB.indexOf("備考");
  
  var timestamp = Utilities.formatDate(new Date(), "Asia/Tokyo", "yyyy/MM");
  
  var updatedDataB = [];
  updatedDataB.push(headerB); // ヘッダー行を保持
  
  for (var i = 1; i < dataA.length; i++) {
    var idA = dataA[i][idColumnA];
    var remarkA = dataA[i][remarkColumnA];
    
    if (idA && remarkA) {
      var found = false;
      
      for (var j = 1; j < dataB.length; j++) {
        if (dataB[j][idColumnB] === idA) {
          // IDが一致した場合、Bシートの行を更新
          var updatedRow = dataA[i].slice(); // Aシートの行をコピー
          updatedRow[remarkColumnB] = dataB[j][remarkColumnB] + "\n" + timestamp + " " + remarkA;
          updatedDataB.push(updatedRow);
          found = true;
          break;
        }
      }
      
      if (!found) {
        // 新規IDの場合、新しい行を追加
        var newRow = dataA[i].slice();
        newRow[remarkColumnB] = timestamp + " " + remarkA;
        updatedDataB.push(newRow);
      }
    }
  }
  
  // Bシートを更新
  sheetB.getRange(1, 1, updatedDataB.length, updatedDataB[0].length).setValues(updatedDataB);
}
